"use strict";angular.module("shoppingCartApp",["ngResource","ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"})}]),angular.module("shoppingCartApp").controller("MainCtrl",["$scope","$http",function(a,b){b.get("containers/products.json").success(function(b){a.items=b}),a.cart=[],a.vouchers=[{value:5,spending_requirement:0,clothing_required:" ",description:"£5 off"},{value:10,spending_requirement:50,clothing_required:" ",description:"£10 off if you spend £50"},{value:15,spending_requirement:75,clothing_required:"Footwear",description:"£15 off if you spend £75 and buy one footwear"}],a.selectedVouchers=[],a.isEmpty=function(){return 0===a.cart.length},a.outOfStock=function(a){return 0===a.quantity?!0:!1},a.addItem=function(b){a.containsObject(b)?b.desiredQuantity+=1:a.cart.push(b),b.quantity-=1},a.removeItem=function(b){var c=a.cart.indexOf(b);a.cart.splice(c,1)},a.total=function(){for(var b=0,c=0;c<a.cart.length;c++)b+=a.cart[c].price*a.cart[c].desiredQuantity;for(var c=0;c<a.selectedVouchers.length;c++)b-=a.selectedVouchers[c].value;return b},a.containsObject=function(b){for(var c=0;c<a.cart.length;c++)if(a.cart[c]===b)return!0;return!1},a.clothingRequirement=function(a,b){for(var c=0;c<b.length;c++)if(b[c].category.indexOf(a.clothing_required)>-1)return!0;return!1},a.selectVoucher=function(b){a.buttonClicked=!1,a.total()>=b.spending_requirement&&a.clothingRequirement(b,a.cart)?(a.selectedVouchers.push(b),a.voucherMessage="Your voucher has been accepted",a.buttonClicked=!0,a.validVoucher="success"):(a.voucherMessage="Sorry, the voucher is invalid",a.validVoucher="danger")}}]);